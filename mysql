CREATE DATABASE IF NOT EXISTS `Projet_Evalu`;

CREATE TABLE collection (
    id INT AUTO_INCREMENT PRIMARY KEY,
    label VARCHAR(100) NOT NULL,
    description TEXT,
    type VARCHAR(30) NOT NULL
) ENGINE=InnoDB DEFAULT CHARSET=UTF8MB4;

CREATE TABLE field (
    id INT AUTO_INCREMENT PRIMARY KEY,
    collection_id INT NOT NULL,
    name VARCHAR(100) NOT NULL,
    label VARCHAR(100) NOT NULL,
    type VARCHAR(30) NOT NULL,
    description TEXT,
    minimum INT,
    maximum INT,
    length INT,
    choiceList TEXT,
    geometry TEXT,
    FOREIGN KEY (collection_id) REFERENCES collection(id) ON DELETE CASCADE
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;


-- create permission pour l'user 

CREATE USER 'evalu_user'@'localhost' IDENTIFIED BY 'evalu_pass';
GRANT ALL PRIVILEGES ON projet_evalu.* TO 'evalu_user'@'localhost';
FLUSH PRIVILEGES;

CREATE TABLE value (
    id INT AUTO_INCREMENT PRIMARY KEY,
    collection_id INT,
    field_name VARCHAR(100),
    field_value TEXT
);
